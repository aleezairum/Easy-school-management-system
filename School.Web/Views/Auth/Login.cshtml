@{
    ViewData["Title"] = "Login";
    Layout = "_LoginLayout";
}

<div class="login-wrapper">
    <div class="login-left">
        <div class="login-left-content">
            <div class="logo-icon">
                <i class="bi bi-mortarboard-fill"></i>
            </div>
            <h1>School Management System</h1>
            <p>A complete solution for managing your educational institution efficiently and effectively.</p>

            <div class="features-list">
                <div class="feature-item">
                    <i class="bi bi-people-fill"></i>
                    <span>Student & Teacher Management</span>
                </div>
                <div class="feature-item">
                    <i class="bi bi-calendar-check-fill"></i>
                    <span>Attendance Tracking</span>
                </div>
                <div class="feature-item">
                    <i class="bi bi-graph-up-arrow"></i>
                    <span>Performance Analytics</span>
                </div>
                <div class="feature-item">
                    <i class="bi bi-shield-check"></i>
                    <span>Secure & Reliable</span>
                </div>
            </div>
        </div>
    </div>

    <div class="login-right">
        <div class="login-form-container">
            <div class="login-header">
                <h2>Welcome Back!</h2>
                <p>Please sign in to access your dashboard</p>
            </div>

            @if (ViewBag.Error != null)
            {
                <div class="alert alert-danger d-flex align-items-center" role="alert">
                    <i class="bi bi-exclamation-circle me-2"></i>
                    @ViewBag.Error
                </div>
            }

            <form method="post" asp-action="Login">
                <div class="mb-4">
                    <label for="session" class="form-label">Academic Session</label>
                    <div class="select-wrapper">
                        <i class="bi bi-calendar3 select-icon"></i>
                        <select class="form-select" id="session" name="session">
                            <option value="1">2023-2024</option>
                            <option value="2" selected>2024-2025</option>
                            <option value="3">2025-2026</option>
                        </select>
                    </div>
                </div>
                <div class="mb-4">
                    <label for="username" class="form-label">Username</label>
                    <div class="input-group">
                        <i class="bi bi-person input-icon"></i>
                        <input type="text" class="form-control" id="username" name="username" placeholder="Enter your username" required>
                    </div>
                </div>
                <div class="mb-3">
                    <label for="password" class="form-label">Password</label>
                    <div class="input-group">
                        <i class="bi bi-lock input-icon"></i>
                        <input type="password" class="form-control" id="password" name="password" placeholder="Enter your password" required>
                    </div>
                </div>

                <div class="form-check mb-4">
                    <input type="checkbox" class="form-check-input" id="rememberMe">
                    <label class="form-check-label" for="rememberMe">Remember me</label>
                </div>

                <button type="submit" class="btn-login">
                    <i class="bi bi-box-arrow-in-right me-2"></i>Sign In
                </button>
            </form>

            <div class="demo-credentials">
                <p><i class="bi bi-info-circle me-1"></i> Demo: <code>admin</code> / <code>admin123</code></p>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Try to load sessions from API, but keep defaults if API fails
            fetch('http://localhost:5266/api/session')
                .then(response => {
                    if (!response.ok) throw new Error('API not available');
                    return response.json();
                })
                .then(sessions => {
                    if (sessions && sessions.length > 0) {
                        const select = document.getElementById('session');
                        select.innerHTML = ''; // Clear defaults
                        sessions.forEach(session => {
                            const option = document.createElement('option');
                            option.value = session.id;
                            option.textContent = session.name;
                            if (session.isCurrent) {
                                option.selected = true;
                            }
                            select.appendChild(option);
                        });
                    }
                })
                .catch(error => {
                    console.log('Using default sessions (API not available)');
                });
        });
    </script>
}
